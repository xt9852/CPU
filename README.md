### 说明
- 这是一个用TTL与非门电路自制CPU项目
- 微指令结构
- 8位数据总线
- 8位地址总线
- 6个8位寄存器(IP,SP,IR,AR,BR,TR)
- 1个8位ALU
- 目前只用Proteus做模拟

### 文件
|文件|说明|
|----|----|
|mi/mi.xls|微指令详细|
|mi/mi.exe|生成微指令工具,将mi_src.txt转化成mi_*.bin|
|mi/MI.c|mi.exe的源代码|
|mi/mi_src.txt|微指令源码|
|mi/mi_*.bin|微指令|
|mi/rom.bin|内存程序|
|cpu.dsn|Proteus的模拟|

### 逻辑结构
![cmd-markdown-logo](https://github.com/xt9852/CPU/blob/master/doc/cpu.png)


### 物理结构
- 微指令驱动部分
    由CLK,CLK_,MINA,MIA组成,主要是对微指令的地址进行操作
- 微指令跳转部分
    SEL0~SEL7,JE,JA,INT,RESET组成,主要是对微指令的地址进行操作,
    通过选择不同的微指令地址以实现微指令跳转
- 微指令存储部分
    MI0~MI5
- 寄存器与总线部分
    IP,SP,IR,AR,BR,D_IP,A_IP,D_SP,A_SP,D_IR,A_IR,D_AR,A_AR,D_BR,A_BR
- ALU与临时寄存器部分
    ALU0~ALU1,TR,T_TR,D_TR
- 内存部分
    ROM

|芯片ID|芯片型号|说明|
|----|----|----|
|CLK||心跳信号|
|CLK_||心跳非信号|
|MINA|74LS373|寄存器,用于保存下一次的微指令地址|
|MIA|74LS373|寄存器,用于保存当前的微指令地址|
|SEL0~SEL7|74LS251|选择器,用于选择不同的下一次的微指令的地址,以实现跳转|
|JE|74LS373|选择器,用于保存MSW的相等信号|
|JA|74LS373|选择器,用于保存MSW的大于信号|
|INT|74LS373|选择器,用于保存MSW的中断信号|
|MI0~MI5|2764|只读存储,用于保存微指令|
|IP|74LS373|程序指针|
|SP|74LS373|堆栈指针|
|IR|74LS373|指令寄存器|
|AR|74LS373|通用寄存器|
|BR|74LS373|通用寄存器|
|D_**|74LS245|驱动器,控制各寄存器与数据总线的连通|
|A_**|74LS245|驱动器,控制各寄存器与地址总线的连通|
|ALU0~ALU1|74LS181|算术逻辑单元|
|TR|74LS373|监时寄存器,用于存储算术逻辑单元输出的数据|
|T_TR|74LS245|驱动器,控制TR与ALU的连通|
|MEM|2764|ROM存储器,模拟内存|


### 数据流
- 微指令跳转部分=>微指令驱动部分=>微指令存储部分=>寄存器与总线部分,ALU与临时寄存器部分,内存部分

### 微代码说明
[微代码详细](https://github.com/xt9852/CPU/blob/master/mi/mi.xls)

|列名称|说明|
|----|----|
|指令|指令名|
|说明|指令说明|
|微代码|微指令执行过程|
|行号|微指令当前位置|
|跳转|微指令下条读句位置|
|译指|读取IR进程译指操作|
|JE跳转|允许JE跳转,用于JE指令|
|JA跳转|允许JA跳转,用于JA指令|
|中断跳转|允许中断跳转,用于标识是否发生中断|
|CE|芯片使能端,0-有效|
|R/W|0-读,1-写|
|O/I|0-输出,1-输入|
|IR_CE,JE_CE,JA_CE,INT_CE|1有效,控制是否跳转,或执行中断操作|

### ALU逻辑
|S0|S1|S2|S3|M|Cn|功能|
|----|----|----|----|----|----|----|
|H|H|L|L|H|*|0|
|L|L|H|H|H|*|1|
|H|H|H|H|H|*|A|
|H|L|H|L|H|*|B|
|L|L|L|L|H|*|A非|
|H|H|L|H|H|*|A与B|
|L|H|H|H|H|*|A或B|
|L|H|H|L|H|*|A异或B|
|H|L|L|H|L|H|A加B|
|H|H|H|L|L|H|A减B|
|L|L|L|L|L|L|A++|
|H|H|H|H|L|H|A--|

### 指令执行过程
- 清空各寄存器操作
- 取指和IP后移操作
- 更新IP操作
- 执行指令操作
- 检测中断操作
